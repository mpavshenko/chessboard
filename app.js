"use strict";function board(e,n){function i(e){var n=$('<div class="cell"></div>').width(v).height(v);return n.append($('<div class="piece"/>').width(v).height(v).css("background-image",e)),n}function t(){Q&&Q.removeClass("clicked"),Q=null}function a(){F=_,$("#arrow-btn").css("background-color","white"),$("#arrow-btn").css("box-shadow","inset 0 0 0 "+v/10+"px "+g),$("#arrow-btn").css("color",g),$("."+b+" .cell, ."+b+" .piece").addClass("cursor-pointer")}function r(){F=null,B=null,$("#arrow-btn").css("background-color",""),$("#arrow-btn").css("box-shadow","none"),$("#arrow-btn").css("color","white"),$("."+b+" .cell, ."+b+" .piece").removeClass("cursor-pointer")}function o(){for(var e=0;e<l.SQUARES.length;e++){var n=l.SQUARES[e],i=l.get(n);if(i){var t=$("#"+n);console.log(e+" "+n+" "+i.type),t.append($('<div id="'+n+'" class="piece"></div>').width(v).height(v).css("background-image","url(img/pieces/"+i.type+i.color+".svg)"))}}}function s(){$(".btn-main").height(v).width(v).css("font-size",v/2).css("line-height",v+"px");var e=$(window).width()-$("#board-container").outerWidth(!0)-$("#pieces-panel").outerWidth(!0)-$("#tools-container").outerHeight(!0)>0,n=$("#tools-container").position().top>0;!n||n&&e?$("#tools-panel>div").removeClass("horizontal").addClass("vertical"):$("#tools-panel>div").removeClass("vertical").addClass("horizontal")}function c(){$(window).width()-$("#board-container").outerWidth(!0)-Math.min($("#pieces-panel").outerWidth(!0),$("#pieces-panel").outerHeight(!0))>0?($("#pieces-panel .cell").css("float","none"),$("#pieces-panel .pieces-panel-row").css("float","left")):($("#pieces-panel .cell").css("float","left"),$("#pieces-panel .pieces-panel-row").css("float","none"))}var l=new Chess;l.reset();var p=$(e),d=$(n),h=window.innerWidth,u=window.innerHeight,g="#2780E3",v=Math.floor((Math.min(h,u)-40)/8.6),w=.3*v,f=8*v+4,m=f+2*w;p.width(m).height(m);for(var b="gameField",k=$('<div class="'+b+'"/>').height(f).width(f),x=[],y=0;y<l.SQUARES.length;y++){var C=l.SQUARES[y],A=l.square_color(C),S=l.get(C),z=$('<div id="'+C+'" class="cell"></div>').width(v).height(v);k.append(z.addClass(A)),S&&z.append($('<div class="piece"></div>').width(v).height(v).css("background-image","url(img/pieces/"+S.type+S.color+".svg)")),x.push(z[0])}for(var E=$("<div>").css("margin-left",w+"px"),R=["A","B","C","D","E","F","G","H"],y=0;y<8;y++){var W=$('<div class="alphabetLetter">'+R[y]+"</div>").width(v).height(w).css("line-height",w+"px").css("font-size",.2*v+"px");E.append(W)}for(var P=$('<div class="numericLetterPanel"/>').width(w),y=8;y>0;y--){var L=$('<div class="numericLetter">'+y+"</div>").css("line-height",v+"px").css("font-size",.2*v+"px");P.append(L)}p.append(E),p.append($("<div/>").append(P).append(k).append(P.clone())),p.append(E.clone());for(var T=["b","w"],U=["r","n","b","k","q","p"],D=$("<div/>"),H=[],y=0;y<T.length;y++){for(var M=$('<div class="pieces-panel-row"/>'),O=0;O<U.length;O++){z=i("url(img/pieces/"+U[O]+T[y]+".svg)");M.append(z),H.push(z[0])}if(0==y){z=i("url(img/pieces/custom/duck.svg)");M.append(z),H.push(z[0]),z=i("url(img/pieces/custom/owl.svg)"),M.append(z),H.push(z[0])}else{z=i("url(img/pieces/custom/pig.svg)");M.append(z),H.push(z[0]),z=i("url(img/pieces/custom/rocket.svg)"),M.append(z),H.push(z[0])}D.append(M)}D.append('<div class="clearfix"/>'),d.append(D).css("padding",w+"px");var Q=null,F=null,_="ARROW_DRAW_MODE",q=$cArrows("."+b),B=null;$(".cell").on("click",function(e){if(e.stopPropagation(),F==_)if($(this).parents("."+b).length>0)if(B){var n=$(this).attr("id");B!=n&&q.arrow("#"+B,"#"+$(this).attr("id"),{arrow:{connectionType:"center"},render:{strokeStyle:g,lineWidth:v/8}}),B=null}else B=$(this).attr("id");else r();else{var i=$(this);Q?(0==i.parents("#pieces-panel").length?(Q.is(i)||i.empty(),Q.parents("#pieces-panel").length>0?$(Q.children()[0]).clone().prependTo(i):$(Q.children()[0]).detach().prependTo(i)):0==Q.parents("#pieces-panel").length&&Q.empty(),0!=Q.parents("#pieces-panel").length&&0!=i.parents(".gameField").length||t()):i.children().length>0&&(Q=i,i.addClass("clicked"))}}),$(window).on("click",function(e){Q&&(0==Q.parents("#pieces-panel").length&&Q.empty(),t()),r()});var G=dragula(x.concat(H),{revertOnSpill:!0,removeOnSpill:!0,accepts:function(e,n,i,t){return!($(n).parents("#pieces-panel").length>0)&&(setTimeout(function(){$(".gu-transit",n).prependTo(n)}),!0)},copy:function(e){return $(e).parents("#pieces-panel").length>0}});G.on("drag",function(e,n){r(),Q&&t()}),G.on("drop",function(e,n,i,t){$(n).children().not(":first").remove()}),$(window).resize(function(){c(),s()}),$(document).ready(function(){c(),s()});var j={};return j.clear=function(){l.clear(),$(".piece",e).remove()},j.initial=function(){j.clear(),l.reset(),o()},j.createArrow=function(e){t(),a(),e.stopPropagation()},j.clearArrowLayout=function(){q.CanvasStorage[2]=[],q.redraw()},j.sizePx=m,j}var board=board("#board-container","#pieces-panel");$("#clear-btn").click(board.clear),$("#initial-btn").click(board.initial),$("#arrow-btn").click(board.createArrow),$("#arrows-delete-btn").click(board.clearArrowLayout),$("#download-image-btn").click(function(e){console.log(board.sizePx),html2canvas($("#board-container"),{onrendered:function(e){document.body.appendChild(e);var n=document.createElement("a"),i=e.toDataURL("image/png");i=i.replace("image/png","image/octet-stream"),document.body.removeChild(e),n.download="board.png",n.href=i,n.click()},width:board.sizePx,height:board.sizePx})});
//# sourceMappingURL=app.js.map
