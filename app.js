"use strict";function board(e,n){function i(e){var n=$('<div class="cell"></div>').width(d).height(d);return n.append($('<div class="piece"/>').width(d).height(d).css("background-image",e)),n}function a(){Q.removeClass("clicked"),Q=null}function t(){for(var e=0;e<p.SQUARES.length;e++){var n=p.SQUARES[e],i=p.get(n);if(i){var a=$("#"+n);console.log(e+" "+n+" "+i.type),a.append($('<div id="'+n+'" class="piece"></div>').width(d).height(d).css("background-image","url(img/pieces/"+i.type+i.color+".svg)"))}}}function c(){$(window).width()-$("#board-container").outerWidth(!0)-Math.min($("#pieces-panel").outerWidth(!0),$("#pieces-panel").outerHeight(!0))>0?($("#pieces-panel .cell").css("float","none"),$("#pieces-panel .pieces-panel-row").css("float","left")):($("#pieces-panel .cell").css("float","left"),$("#pieces-panel .pieces-panel-row").css("float","none"))}var p=new Chess;p.reset();var s=$(e),r=$(n),l=window.innerWidth,o=window.innerHeight,d=Math.floor((Math.min(l,o)-40)/8.6),h=.3*d,g=8*d+4,u=g+2*h;s.width(u).height(u);for(var v=$('<div class="gameField"/>').height(g).width(g),m=[],f=0;f<p.SQUARES.length;f++){var w=p.SQUARES[f],b=p.square_color(w),k=p.get(w),x=$('<div id="'+w+'" class="cell"></div>').width(d).height(d);v.append(x.addClass(b)),k&&x.append($('<div id="'+w+'" class="piece"></div>').width(d).height(d).css("background-image","url(img/pieces/"+k.type+k.color+".svg)")),m.push(x[0])}for(var y=$("<div>").css("margin-left",h+"px"),S=["A","B","C","D","E","F","G","H"],f=0;f<8;f++){var z=$('<div class="alphabetLetter">'+S[f]+"</div>").width(d).height(h).css("line-height",h+"px").css("font-size",.2*d+"px");y.append(z)}for(var C=$('<div class="numericLetterPanel"/>').width(h),f=8;f>0;f--){var E=$('<div class="numericLetter">'+f+"</div>").css("line-height",d+"px").css("font-size",.2*d+"px");C.append(E)}s.append(y),s.append($("<div/>").append(C).append(v).append(C.clone())),s.append(y.clone());for(var P=["b","w"],A=["r","n","b","k","q","p"],R=$("<div/>"),T=[],f=0;f<P.length;f++){for(var U=$('<div class="pieces-panel-row"/>'),L=0;L<A.length;L++){x=i("url(img/pieces/"+A[L]+P[f]+".svg)");U.append(x),T.push(x[0])}if(0==f){x=i("url(img/pieces/custom/duck.svg)");U.append(x),T.push(x[0]),x=i("url(img/pieces/custom/owl.svg)"),U.append(x),T.push(x[0])}else{x=i("url(img/pieces/custom/pig.svg)");U.append(x),T.push(x[0]),x=i("url(img/pieces/custom/rocket.svg)"),U.append(x),T.push(x[0])}R.append(U)}R.append('<div class="clearfix"/>'),r.append(R).css("padding",h+"px");var Q=null;setTimeout(function(){$(".cell").on("click",function(e){e.stopPropagation();var n=$(this);Q?(0==n.parents("#pieces-panel").length?(Q.is(n)||n.empty(),Q.parents("#pieces-panel").length>0?$(Q.children()[0]).clone().prependTo(n):$(Q.children()[0]).detach().prependTo(n)):0==Q.parents("#pieces-panel").length&&Q.empty(),a()):n.children().length>0&&(Q=n,n.addClass("clicked"))}),$(window).on("click",function(e){Q&&(0==Q.parents("#pieces-panel").length&&Q.empty(),a())})});var H=dragula(m.concat(T),{revertOnSpill:!0,removeOnSpill:!0,accepts:function(e,n,i,a){return!($(n).parents("#pieces-panel").length>0)&&(setTimeout(function(){$(".gu-transit",n).prependTo(n)}),!0)},copy:function(e){return $(e).parents("#pieces-panel").length>0}});H.on("drag",function(e,n){Q&&a()}),H.on("drop",function(e,n,i,a){$(n).children().not(":first").remove()}),$(window).resize(function(){c()}),$(document).ready(function(){c()});var M={};return M.clear=function(){p.clear(),$(".piece",e).remove()},M.initial=function(){M.clear(),p.reset(),t()},M.sizePx=u,M}var board=board("#board-container","#pieces-panel");$("#clear-btn").click(board.clear),$("#initial-btn").click(board.initial),$("#download-image-btn").click(function(e){console.log(board.sizePx),html2canvas($("#board-container"),{onrendered:function(e){document.body.appendChild(e);var n=document.createElement("a"),i=e.toDataURL("image/png");i=i.replace("image/png","image/octet-stream"),document.body.removeChild(e),n.download="board.png",n.href=i,n.click()},width:board.sizePx,height:board.sizePx})});
//# sourceMappingURL=app.js.map
