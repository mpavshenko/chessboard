"use strict";function board(e,i){function n(){U.removeClass("clicked"),U=null}function a(){for(var e=0;e<t.SQUARES.length;e++){var i=t.SQUARES[e],n=t.get(i);if(n){var a=$("#"+i);console.log(e+" "+i+" "+n.type),a.append($('<div id="'+i+'" class="piece"></div>').width(p).height(p).css("background-image","url(img/pieces/"+n.type+n.color+".svg)"))}}}var t=new Chess;t.reset();var c=$(e),r=$(i),d=window.innerWidth,l=window.innerHeight,p=Math.floor((Math.min(d,l)-40)/8.6),s=.3*p,o=8*p+4,h=o+2*s;c.width(h).height(h);for(var g=$('<div class="gameField"/>').height(o).width(o),v=[],u=0;u<t.SQUARES.length;u++){var m=t.SQUARES[u],f=t.square_color(m),b=t.get(m),w=$('<div id="'+m+'" class="cell"></div>').width(p).height(p);g.append(w.addClass(f)),b&&w.append($('<div id="'+m+'" class="piece"></div>').width(p).height(p).css("background-image","url(img/pieces/"+b.type+b.color+".svg)")),v.push(w[0])}for(var k=$("<div>").css("margin-left",s+"px"),x=["A","B","C","D","E","F","G","H"],u=0;u<8;u++){var S=$('<div class="alphabetLetter">'+x[u]+"</div>").width(p).height(s).css("line-height",s+"px").css("font-size",.2*p+"px");k.append(S)}for(var y=$('<div class="numericLetterPanel"/>').width(s),u=8;u>0;u--){var C=$('<div class="numericLetter">'+u+"</div>").css("line-height",p+"px").css("font-size",.2*p+"px");y.append(C)}c.append(k),c.append($("<div/>").append(y).append(g).append(y.clone())),c.append(k.clone());for(var z=["b","w"],E=["r","n","b","k","q","p"],P=$("<div/>"),A=[],u=0;u<z.length;u++){for(var R=$('<div class="'+z[u]+'"/>'),T=0;T<E.length;T++)(w=$('<div class="cell"></div>').width(p).height(p)).append($('<div class="piece"/>').width(p).height(p).css("background-image","url(img/pieces/"+E[T]+z[u]+".svg)")),R.append(w),A.push(w[0]);P.append(R)}P.append('<div class="clearfix"/>'),r.append(P).css("padding",s+"px");var U=null;setTimeout(function(){$(".cell").on("click",function(e){e.stopPropagation();var i=$(this);U?(0==i.parents("#pieces-panel").length?(U.is(i)||i.empty(),U.parents("#pieces-panel").length>0?$(U.children()[0]).clone().prependTo(i):$(U.children()[0]).detach().prependTo(i)):0==U.parents("#pieces-panel").length&&U.empty(),n()):i.children().length>0&&(U=i,i.addClass("clicked"))}),$(window).on("click",function(e){U&&(0==U.parents("#pieces-panel").length&&U.empty(),n())})}),dragula(v.concat(A),{revertOnSpill:!0,removeOnSpill:!0,accepts:function(e,i,a,t){return U&&n(),!($(i).parents("#pieces-panel").length>0)&&(setTimeout(function(){$(e).hasClass("gu-transit")?$($(e).detach().prependTo($(i))):$(e).parent().children().not(":first").remove()}),!0)},copy:function(e){return $(e).parents("#pieces-panel").length>0}});var L={};return L.clear=function(){t.clear(),$(".piece",e).remove()},L.initial=function(){L.clear(),t.reset(),a()},L.sizePx=h,L}var board=board("#board-container","#pieces-panel");$("#clear-btn").click(board.clear),$("#initial-btn").click(board.initial),$("#download-image-btn").click(function(e){console.log(board.sizePx),html2canvas($("#board-container"),{onrendered:function(e){document.body.appendChild(e);var i=document.createElement("a"),n=e.toDataURL("image/png");n=n.replace("image/png","image/octet-stream"),document.body.removeChild(e),i.download="board.png",i.href=n,i.click()},width:board.sizePx,height:board.sizePx})});
//# sourceMappingURL=app.js.map
